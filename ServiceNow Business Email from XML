    // Add your code here
    var lsid = "";
    var timestamp = "";
    lsid = 'c8836e15d2d84184b5da93159e60bb09';

    // Do a rest command to check for type of session
    var request = new sn_ws.RESTMessageV2();
    request.setEndpoint('https://atsg.bomgarcloud.com/oauth2/token?grant_type=client_credentials');
    request.setHttpMethod('POST');

    var user = 'e1969e55cb4d934e4b7a34ece376613519a244a8';
    var password = 'mJ1hsWNAH9hvYZj69VtQKI9/JyEN4CW5OLwqOhRhuV0K';

    request.setBasicAuth(user, password);
    request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    request.setRequestBody('grant_type=client_credentials');

    var response = request.execute();
    var responsebody = response.getBody();
    var parser = new JSONParser();
    var parsed = {};
    parsed = parser.parse(responsebody);

    var access_token = parsed.access_token.trim();

    var Bearer = "Bearer " + access_token;

    //Create XMLReader
    var xmlDoc = new XMLDocument2();
    //Set reports URL using lsid
    var reporturl = 'https://atsg.bomgarcloud.com/api/reporting?generate_report=SupportSession&lsid=' + lsid;
    //Acquire report via REST using the token
    var reportrequest = new sn_ws.RESTMessageV2();
    reportrequest.setEndpoint(reporturl);
    reportrequest.setHttpMethod('GET');
    reportrequest.setRequestHeader("Authorization", Bearer);
    reportrequest.setRequestHeader("Accept", "*/*");

    var thisreport = reportrequest.execute();

    var reportxml = thisreport.getBody();
    var start_time = reportxml.split("start_time")[1].split(">")[1].split("<")[0];
    var end_time = reportxml.split("end_time")[1].split(">")[1].split("<")[0];
    var duration = reportxml.split("duration")[1].split(">")[1].split("<")[0];
    var SessionTypeCount = (reportxml.match(/display_name="Session Type"/g) || []).length;
    //Start Parsing Report XML
    xmlDoc.parseXML(reportxml);

    var customerlistinfo = xmlDoc.getFirstNode('/session_list/session/customer_list/customer/info/issue').getTextContent();
    gs.log("customerlistinfo is " + customerlistinfo);
    var infolength = customerlistinfo.length;
    gs.log("infolength is " + infolength);
    var externalkey = xmlDoc.getFirstNode('/session_list/session/external_key').getTextContent();
    gs.log("externalkey is " + externalkey);
    var externalkeylength = externalkey.length;
    gs.log("externalkeylength is " + externalkeylength);
    var issuedetails = xmlDoc.getFirstNode('/session_list/session/customer_list/customer/info/details').getTextContent();
    gs.log("issuedetails" + issuedetails);


    if (externalkeylength > 3 || infolength < 3) {
        gs.log('NON Ticket Generating BT Session');
    } else {
        gs.log('Getting Bus Email for BT Session');
        var businessemail = reportxml.split('<custom_attribute ')[1].split('>')[1].split('<')[0];
        gs.log("email is " + businessemail);
    }
